{"version":3,"file":"carousel.js","sources":["carousel.js"],"sourcesContent":["// component\nexport default class Carousel {\n\tconstructor(id, rawopts) {\n\t\t/* Set Options\n\t\t/* ================================================================== */\n\n\t\tconst opts = Object(rawopts);\n\n\t\t// set the options from Carousel defaults\n\t\tfor (let key in Carousel.defaults) {\n\t\t\tthis[key] = key in opts ? opts[key] : Carousel.defaults[key];\n\t\t}\n\n\t\t/* Initialize the Target Element\n\t\t/* ================================================================== */\n\n\t\tconst $target = this.target = id instanceof Element ? id : document.querySelector(id);\n\n\t\t// set the prefix as the root class\n\t\t$target.classList.add(this.prefix);\n\n\t\t// set the prefix as the fallback id (needed for aria-labelledby)\n\t\t$target.id = $target.id || this.prefix;\n\n\t\t/* Initialize the Previous and Next Immediate Controls\n\t\t/* ================================================================== */\n\n\t\tconst initImmediateControl = (variation, offset) => {\n\t\t\tconst $control = this[variation + 'Control'] = document.createElement('button');\n\n\t\t\t$control.className = `${ this.prefix }-immediate-control ${ this.prefix }-${ variation }-control`;\n\n\t\t\t$control.addEventListener('click', () => {\n\t\t\t\tthis.setSlideByIndex(this.currentIndex + offset);\n\t\t\t});\n\n\t\t\t// create label for immediate control\n\t\t\t$control.appendChild(\n\t\t\t\tdocument.createElement('span')\n\t\t\t).appendChild(\n\t\t\t\tdocument.createTextNode(`${ this.lang[variation] } ${ this.lang.slide }`)\n\t\t\t);\n\t\t};\n\n\t\t// create previous and next immediate controls\n\t\tinitImmediateControl('previous', -1);\n\t\tinitImmediateControl('next', 1);\n\n\t\t// prepend the previous control to the target\n\t\t$target.insertBefore(this.previousControl, $target.firstElementChild);\n\n\t\t// append the next control to the target\n\t\t$target.appendChild(this.nextControl);\n\n\t\t/* Initialize Pagination Controls\n\t\t/* ================================================================== */\n\n\t\tconst $pagination = this.paginationControls = document.createElement('nav');\n\n\t\t$pagination.className = `${ this.prefix }-pagination-controls`;\n\n\t\t$pagination.setAttribute('role', 'navigation');\n\t\t$pagination.setAttribute('aria-labelledby', $target.id);\n\n\t\t// append the pagination controls to the target\n\t\t$target.appendChild($pagination);\n\n\t\t/* Initialize Slides\n\t\t/* ================================================================== */\n\n\t\tthis.paginationControl = [];\n\n\t\tthis.slides = [].map.call(\n\t\t\t// get slides from an array-like object or a selector string\n\t\t\tObject(this.slides) === this.slides && 'number' === typeof this.slides.length\n\t\t\t\t? this.slides\n\t\t\t\t: $target.querySelectorAll(this.slides),\n\t\t\t($slide, index) => {\n\t\t\t\t$slide.id = $slide.id || `${ this.prefix }-slide-${ index }`;\n\n\t\t\t\t$slide.classList.add(`${ this.prefix }-slide`);\n\t\t\t\t$slide.classList.add(`${ this.prefix }-slide-${ index }`);\n\t\t\t\t$slide.classList.add(`${ this.prefix }-inactive-slide`);\n\n\t\t\t\t$slide.setAttribute('aria-hidden', true);\n\n\t\t\t\t// create the pagination control for the slide\n\t\t\t\tconst $control = this.paginationControl[index] = $pagination.appendChild(\n\t\t\t\t\tdocument.createElement('button')\n\t\t\t\t);\n\n\t\t\t\t$control.className = `${ this.prefix }-pagination-control ${ this.prefix }-inactive-control`;\n\n\t\t\t\t$control.addEventListener('click', () => {\n\t\t\t\t\tthis.setSlideByIndex(index);\n\t\t\t\t});\n\n\t\t\t\t// create the label for pagination control for the slide\n\t\t\t\t$control.appendChild(\n\t\t\t\t\tdocument.createElement('span')\n\t\t\t\t).appendChild(\n\t\t\t\t\tdocument.createTextNode(`${ this.lang.slide } ${ index + 1 }`)\n\t\t\t\t);\n\n\t\t\t\t// return the slide and its pagination control\n\t\t\t\treturn {\n\t\t\t\t\ttarget:   $slide,\n\t\t\t\t\tcontrol:  $control\n\t\t\t\t};\n\t\t\t}\n\t\t);\n\n\t\t/* Manage Interactive States\n\t\t/* ================================================================== */\n\n\t\tthis.isVisible = true;\n\t\tthis.isMouseInteractive = false;\n\t\tthis.isFocusInteractive = false;\n\t\tthis.isInputInteractive = false;\n\n\t\t// manage interactive changes\n\t\tconst oninteractivechange = (event) => {\n\t\t\t// update the visibility state\n\t\t\tconst isVisibleNow = 'visibilitychange' === event.type ? 'visible' === $target.ownerDocument.visibilityState : this.isVisible;\n\n\t\t\t// update the input states\n\t\t\tconst isMouseInteractiveNow = 'mouseenter' === event.type ? true : 'mouseleave' === event.type ? false : this.isMouseInteractive;\n\t\t\tconst isFocusInteractiveNow =    'focusin' === event.type ? true :   'focusout' === event.type ? false : this.isFocusInteractive;\n\n\t\t\t// update the interactive state\n\t\t\tconst isInputInteractiveNow = isMouseInteractiveNow || isFocusInteractiveNow;\n\n\t\t\t// if the visibility state has changed\n\t\t\tif (isVisibleNow !== this.isVisible) {\n\t\t\t\t// dispatch a change event when the document changes visibility\n\t\t\t\tthis.isVisible = isVisibleNow;\n\n\t\t\t\tif (this.autoplay) {\n\t\t\t\t\tthis[isVisibleNow ? 'play' : 'pause']();\n\t\t\t\t}\n\n\t\t\t\tthis.dispatch(isVisibleNow ? 'visibilityvisible' : 'visibilityhidden', event.target);\n\t\t\t\tthis.dispatch('visibilitychange', event.target);\n\t\t\t}\n\n\t\t\t// if the mouse state has changed\n\t\t\tif (isMouseInteractiveNow !== this.isMouseInteractive) {\n\t\t\t\t// dispatch a change event when a mouse is entering or leaving the carousel\n\t\t\t\tthis.isMouseInteractive = isMouseInteractiveNow;\n\n\t\t\t\tthis.dispatch(isMouseInteractiveNow ? 'mouseenter' : 'mouseleave', event.target);\n\t\t\t\tthis.dispatch('mousechange', event.target);\n\t\t\t}\n\n\t\t\t// if the focus state has changed\n\t\t\tif (isFocusInteractiveNow !== this.isFocusInteractive) {\n\t\t\t\t// dispatch a change event when a keyboard is entering or leaving the carousel\n\t\t\t\tthis.isFocusInteractive = isFocusInteractiveNow;\n\n\t\t\t\tif (this.autoplay) {\n\t\t\t\t\tthis[isFocusInteractiveNow ? 'pause' : 'play']();\n\t\t\t\t}\n\n\t\t\t\tthis.dispatch(isFocusInteractiveNow ? 'focusenter' : 'focusleave', event.target);\n\t\t\t\tthis.dispatch('focuschange', event.target);\n\t\t\t}\n\n\t\t\t// if the interactive state has changed\n\t\t\tif (isInputInteractiveNow !== this.isInputInteractive) {\n\t\t\t\t// dispatch a change event when a mouse or keyboard is entering or leaving the carousel\n\t\t\t\tthis.isInputInteractive = isInputInteractiveNow;\n\n\t\t\t\tthis.dispatch(isInputInteractiveNow ? 'inputenter' : 'inputleave', event.target);\n\t\t\t\tthis.dispatch('inputchange', event.target);\n\t\t\t}\n\t\t}\n\n\t\t// listen for visibility changes\n\t\t$target.ownerDocument.addEventListener('visibilitychange', oninteractivechange);\n\n\t\t// listen for input events\n\t\t$target.addEventListener('mouseenter', oninteractivechange);\n\t\t$target.addEventListener('mouseleave', oninteractivechange);\n\t\t$target.addEventListener('focusout',   onfocuschange);\n\t\t$target.addEventListener('focusin',    onfocuschange);\n\n\t\t// manage the focus event (using a slight delay)\n\t\tlet focusTimeout;\n\n\t\tfunction onfocuschange() {\n\t\t\tclearTimeout(focusTimeout);\n\n\t\t\tfocusTimeout = setTimeout(oninteractivechange, 0, event);\n\t\t}\n\n\t\t/* Initialize the Current Slide\n\t\t/* ================================================================== */\n\n\t\tconst cachedIndex = this.currentIndex || 0;\n\n\t\tthis.currentIndex = null;\n\n\t\tthis.setSlideByIndex(cachedIndex);\n\n\t\t/* Dispatch the Loaded Event\n\t\t/* ================================================================== */\n\n\t\tthis.dispatch('loaded', $target);\n\n\t\t/* Start Autoplay\n\t\t/* ================================================================== */\n\n\t\tif (this.autoplay) {\n\t\t\tthis.play();\n\t\t}\n\t}\n\n\t/* Set Slide By Index\n\t/* ================================================================== */\n\n\tsetSlideByIndex(index) {\n\t\tif (this.currentIndex !== index) {\n\t\t\t// set the length using the total number of slides\n\t\t\tconst length   = this.slides.length;\n\n\t\t\t// set the old and new indexes and slides using a modulus\n\t\t\tconst oldIndex = this.lastIndex = this.currentIndex;\n\t\t\tconst newIndex = this.currentIndex = (length + index % length) % length;\n\n\t\t\tconst oldSlide = this.slides[oldIndex];\n\t\t\tconst newSlide = this.slides[newIndex];\n\n\t\t\tif (oldSlide) {\n\t\t\t\t// update the old slide\n\t\t\t\toldSlide.target.classList.remove(`${ this.prefix }-active-slide`);\n\t\t\t\toldSlide.target.classList.add(`${ this.prefix }-inactive-slide`);\n\t\t\t\toldSlide.target.setAttribute('aria-hidden', true);\n\n\t\t\t\t// update the old slide control\n\t\t\t\toldSlide.control.classList.remove(`${ this.prefix }-active-control`);\n\t\t\t\toldSlide.control.classList.add(`${ this.prefix }-inactive-control`);\n\t\t\t\toldSlide.control.removeAttribute('aria-current');\n\t\t\t\toldSlide.control.removeAttribute('aria-controls');\n\n\t\t\t\t// dispatch the slideleave event from the old slide target\n\t\t\t\tthis.dispatch('slideleave', oldSlide.target);\n\t\t\t}\n\n\t\t\t// update the new slide\n\t\t\tnewSlide.target.classList.add(`${ this.prefix }-active-slide`);\n\t\t\tnewSlide.target.classList.remove(`${ this.prefix }-inactive-slide`);\n\t\t\tnewSlide.target.removeAttribute('aria-hidden');\n\n\t\t\t// update the new slide control\n\t\t\tnewSlide.control.classList.add(`${ this.prefix }-active-control`);\n\t\t\tnewSlide.control.classList.remove(`${ this.prefix }-inactive-control`);\n\t\t\tnewSlide.control.setAttribute('aria-current', true);\n\t\t\tnewSlide.control.setAttribute('aria-controls', newSlide.target.id);\n\n\t\t\t// dispatch slideenter and slidechange events from the new slide target\n\t\t\tthis.dispatch('slideenter', newSlide.target);\n\t\t\tthis.dispatch('slidechange', newSlide.target);\n\t\t}\n\t}\n\n\t/* Dispatch a Prefixed Custom Event bound to the instance\n\t/* ================================================================== */\n\n\tdispatch(type, target) {\n\t\tconst event = document.createEvent('CustomEvent');\n\n\t\tevent.initCustomEvent(`${ this.prefix }:${ type }`, true, false, this);\n\n\t\ttarget.dispatchEvent(event);\n\t}\n\n\t/* Start automatic Slide progression (using Durations)\n\t/* ================================================================== */\n\n\tplay() {\n\t\tconst onplay = () => {\n\t\t\tconst duration = this.slides[this.currentIndex].duration || this.duration;\n\n\t\t\tthis._interval = setTimeout(\n\t\t\t\t() => {\n\t\t\t\t\tthis.setSlideByIndex(this.currentIndex + 1);\n\n\t\t\t\t\tif (this._interval) {\n\t\t\t\t\t\tthis._interval = clearTimeout(this._interval);\n\n\t\t\t\t\t\tonplay();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tduration\n\t\t\t);\n\t\t};\n\n\t\tif (!this._interval) {\n\t\t\tonplay();\n\n\t\t\tthis.dispatch('play', this.target);\n\t\t\tthis.dispatch('playpause', this.target);\n\t\t}\n\t}\n\n\t/* Pause automatic Slide progression\n\t/* ================================================================== */\n\n\tpause() {\n\t\tif (this._interval) {\n\t\t\tthis._interval = clearTimeout(this._interval);\n\n\t\t\tthis.dispatch('pause', this.target);\n\t\t\tthis.dispatch('playpause', this.target);\n\t\t}\n\t}\n}\n\n// default options\nCarousel.defaults = {\n\tprefix: 'carousel',\n\tslides: 'li',\n\tcurrentIndex: 0,\n\tduration: 8000,\n\tautoplay: false,\n\tlang: {\n\t\tnext: 'Next',\n\t\tprevious: 'Previous',\n\t\tslide: 'Slide'\n\t}\n};\n"],"names":["Carousel","id","rawopts","onfocuschange","focusTimeout","setTimeout","oninteractivechange","event","opts","Object","key","defaults","$target","this","target","Element","document","querySelector","classList","add","prefix","initImmediateControl","variation","offset","$control","_this","createElement","className","addEventListener","setSlideByIndex","currentIndex","appendChild","createTextNode","lang","slide","insertBefore","previousControl","firstElementChild","nextControl","$pagination","paginationControls","setAttribute","paginationControl","slides","map","call","length","querySelectorAll","$slide","index","isVisible","isMouseInteractive","isFocusInteractive","isInputInteractive","isVisibleNow","type","ownerDocument","visibilityState","isMouseInteractiveNow","isFocusInteractiveNow","isInputInteractiveNow","autoplay","dispatch","cachedIndex","play","oldIndex","lastIndex","newIndex","oldSlide","newSlide","remove","control","removeAttribute","createEvent","initCustomEvent","dispatchEvent","_interval","onplay","duration","_this2","clearTimeout"],"mappings":"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","preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb25hdGhhbm5lYWwvR2l0SHViL2pvbmF0aGFudG5lYWwvY2Fyb3VzZWwvY2Fyb3VzZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gY29tcG9uZW50XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJvdXNlbCB7XG5cdGNvbnN0cnVjdG9yKGlkLCByYXdvcHRzKSB7XG5cdFx0LyogU2V0IE9wdGlvbnNcblx0XHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRcdGNvbnN0IG9wdHMgPSBPYmplY3QocmF3b3B0cyk7XG5cblx0XHQvLyBzZXQgdGhlIG9wdGlvbnMgZnJvbSBDYXJvdXNlbCBkZWZhdWx0c1xuXHRcdGZvciAobGV0IGtleSBpbiBDYXJvdXNlbC5kZWZhdWx0cykge1xuXHRcdFx0dGhpc1trZXldID0ga2V5IGluIG9wdHMgPyBvcHRzW2tleV0gOiBDYXJvdXNlbC5kZWZhdWx0c1trZXldO1xuXHRcdH1cblxuXHRcdC8qIEluaXRpYWxpemUgdGhlIFRhcmdldCBFbGVtZW50XG5cdFx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0XHRjb25zdCAkdGFyZ2V0ID0gdGhpcy50YXJnZXQgPSBpZCBpbnN0YW5jZW9mIEVsZW1lbnQgPyBpZCA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaWQpO1xuXG5cdFx0Ly8gc2V0IHRoZSBwcmVmaXggYXMgdGhlIHJvb3QgY2xhc3Ncblx0XHQkdGFyZ2V0LmNsYXNzTGlzdC5hZGQodGhpcy5wcmVmaXgpO1xuXG5cdFx0Ly8gc2V0IHRoZSBwcmVmaXggYXMgdGhlIGZhbGxiYWNrIGlkIChuZWVkZWQgZm9yIGFyaWEtbGFiZWxsZWRieSlcblx0XHQkdGFyZ2V0LmlkID0gJHRhcmdldC5pZCB8fCB0aGlzLnByZWZpeDtcblxuXHRcdC8qIEluaXRpYWxpemUgdGhlIFByZXZpb3VzIGFuZCBOZXh0IEltbWVkaWF0ZSBDb250cm9sc1xuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0Y29uc3QgaW5pdEltbWVkaWF0ZUNvbnRyb2wgPSAodmFyaWF0aW9uLCBvZmZzZXQpID0+IHtcblx0XHRcdGNvbnN0ICRjb250cm9sID0gdGhpc1t2YXJpYXRpb24gKyAnQ29udHJvbCddID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cblx0XHRcdCRjb250cm9sLmNsYXNzTmFtZSA9IGAkeyB0aGlzLnByZWZpeCB9LWltbWVkaWF0ZS1jb250cm9sICR7IHRoaXMucHJlZml4IH0tJHsgdmFyaWF0aW9uIH0tY29udHJvbGA7XG5cblx0XHRcdCRjb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNldFNsaWRlQnlJbmRleCh0aGlzLmN1cnJlbnRJbmRleCArIG9mZnNldCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gY3JlYXRlIGxhYmVsIGZvciBpbW1lZGlhdGUgY29udHJvbFxuXHRcdFx0JGNvbnRyb2wuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuXHRcdFx0KS5hcHBlbmRDaGlsZChcblx0XHRcdFx0ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYCR7IHRoaXMubGFuZ1t2YXJpYXRpb25dIH0gJHsgdGhpcy5sYW5nLnNsaWRlIH1gKVxuXHRcdFx0KTtcblx0XHR9O1xuXG5cdFx0Ly8gY3JlYXRlIHByZXZpb3VzIGFuZCBuZXh0IGltbWVkaWF0ZSBjb250cm9sc1xuXHRcdGluaXRJbW1lZGlhdGVDb250cm9sKCdwcmV2aW91cycsIC0xKTtcblx0XHRpbml0SW1tZWRpYXRlQ29udHJvbCgnbmV4dCcsIDEpO1xuXG5cdFx0Ly8gcHJlcGVuZCB0aGUgcHJldmlvdXMgY29udHJvbCB0byB0aGUgdGFyZ2V0XG5cdFx0JHRhcmdldC5pbnNlcnRCZWZvcmUodGhpcy5wcmV2aW91c0NvbnRyb2wsICR0YXJnZXQuZmlyc3RFbGVtZW50Q2hpbGQpO1xuXG5cdFx0Ly8gYXBwZW5kIHRoZSBuZXh0IGNvbnRyb2wgdG8gdGhlIHRhcmdldFxuXHRcdCR0YXJnZXQuYXBwZW5kQ2hpbGQodGhpcy5uZXh0Q29udHJvbCk7XG5cblx0XHQvKiBJbml0aWFsaXplIFBhZ2luYXRpb24gQ29udHJvbHNcblx0XHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRcdGNvbnN0ICRwYWdpbmF0aW9uID0gdGhpcy5wYWdpbmF0aW9uQ29udHJvbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCduYXYnKTtcblxuXHRcdCRwYWdpbmF0aW9uLmNsYXNzTmFtZSA9IGAkeyB0aGlzLnByZWZpeCB9LXBhZ2luYXRpb24tY29udHJvbHNgO1xuXG5cdFx0JHBhZ2luYXRpb24uc2V0QXR0cmlidXRlKCdyb2xlJywgJ25hdmlnYXRpb24nKTtcblx0XHQkcGFnaW5hdGlvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsICR0YXJnZXQuaWQpO1xuXG5cdFx0Ly8gYXBwZW5kIHRoZSBwYWdpbmF0aW9uIGNvbnRyb2xzIHRvIHRoZSB0YXJnZXRcblx0XHQkdGFyZ2V0LmFwcGVuZENoaWxkKCRwYWdpbmF0aW9uKTtcblxuXHRcdC8qIEluaXRpYWxpemUgU2xpZGVzXG5cdFx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0XHR0aGlzLnBhZ2luYXRpb25Db250cm9sID0gW107XG5cblx0XHR0aGlzLnNsaWRlcyA9IFtdLm1hcC5jYWxsKFxuXHRcdFx0Ly8gZ2V0IHNsaWRlcyBmcm9tIGFuIGFycmF5LWxpa2Ugb2JqZWN0IG9yIGEgc2VsZWN0b3Igc3RyaW5nXG5cdFx0XHRPYmplY3QodGhpcy5zbGlkZXMpID09PSB0aGlzLnNsaWRlcyAmJiAnbnVtYmVyJyA9PT0gdHlwZW9mIHRoaXMuc2xpZGVzLmxlbmd0aFxuXHRcdFx0XHQ/IHRoaXMuc2xpZGVzXG5cdFx0XHRcdDogJHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuc2xpZGVzKSxcblx0XHRcdCgkc2xpZGUsIGluZGV4KSA9PiB7XG5cdFx0XHRcdCRzbGlkZS5pZCA9ICRzbGlkZS5pZCB8fCBgJHsgdGhpcy5wcmVmaXggfS1zbGlkZS0keyBpbmRleCB9YDtcblxuXHRcdFx0XHQkc2xpZGUuY2xhc3NMaXN0LmFkZChgJHsgdGhpcy5wcmVmaXggfS1zbGlkZWApO1xuXHRcdFx0XHQkc2xpZGUuY2xhc3NMaXN0LmFkZChgJHsgdGhpcy5wcmVmaXggfS1zbGlkZS0keyBpbmRleCB9YCk7XG5cdFx0XHRcdCRzbGlkZS5jbGFzc0xpc3QuYWRkKGAkeyB0aGlzLnByZWZpeCB9LWluYWN0aXZlLXNsaWRlYCk7XG5cblx0XHRcdFx0JHNsaWRlLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcblxuXHRcdFx0XHQvLyBjcmVhdGUgdGhlIHBhZ2luYXRpb24gY29udHJvbCBmb3IgdGhlIHNsaWRlXG5cdFx0XHRcdGNvbnN0ICRjb250cm9sID0gdGhpcy5wYWdpbmF0aW9uQ29udHJvbFtpbmRleF0gPSAkcGFnaW5hdGlvbi5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHRkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdCRjb250cm9sLmNsYXNzTmFtZSA9IGAkeyB0aGlzLnByZWZpeCB9LXBhZ2luYXRpb24tY29udHJvbCAkeyB0aGlzLnByZWZpeCB9LWluYWN0aXZlLWNvbnRyb2xgO1xuXG5cdFx0XHRcdCRjb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2V0U2xpZGVCeUluZGV4KGluZGV4KTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gY3JlYXRlIHRoZSBsYWJlbCBmb3IgcGFnaW5hdGlvbiBjb250cm9sIGZvciB0aGUgc2xpZGVcblx0XHRcdFx0JGNvbnRyb2wuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG5cdFx0XHRcdCkuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYCR7IHRoaXMubGFuZy5zbGlkZSB9ICR7IGluZGV4ICsgMSB9YClcblx0XHRcdFx0KTtcblxuXHRcdFx0XHQvLyByZXR1cm4gdGhlIHNsaWRlIGFuZCBpdHMgcGFnaW5hdGlvbiBjb250cm9sXG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0dGFyZ2V0OiAgICRzbGlkZSxcblx0XHRcdFx0XHRjb250cm9sOiAgJGNvbnRyb2xcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0LyogTWFuYWdlIEludGVyYWN0aXZlIFN0YXRlc1xuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0dGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuXHRcdHRoaXMuaXNNb3VzZUludGVyYWN0aXZlID0gZmFsc2U7XG5cdFx0dGhpcy5pc0ZvY3VzSW50ZXJhY3RpdmUgPSBmYWxzZTtcblx0XHR0aGlzLmlzSW5wdXRJbnRlcmFjdGl2ZSA9IGZhbHNlO1xuXG5cdFx0Ly8gbWFuYWdlIGludGVyYWN0aXZlIGNoYW5nZXNcblx0XHRjb25zdCBvbmludGVyYWN0aXZlY2hhbmdlID0gKGV2ZW50KSA9PiB7XG5cdFx0XHQvLyB1cGRhdGUgdGhlIHZpc2liaWxpdHkgc3RhdGVcblx0XHRcdGNvbnN0IGlzVmlzaWJsZU5vdyA9ICd2aXNpYmlsaXR5Y2hhbmdlJyA9PT0gZXZlbnQudHlwZSA/ICd2aXNpYmxlJyA9PT0gJHRhcmdldC5vd25lckRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA6IHRoaXMuaXNWaXNpYmxlO1xuXG5cdFx0XHQvLyB1cGRhdGUgdGhlIGlucHV0IHN0YXRlc1xuXHRcdFx0Y29uc3QgaXNNb3VzZUludGVyYWN0aXZlTm93ID0gJ21vdXNlZW50ZXInID09PSBldmVudC50eXBlID8gdHJ1ZSA6ICdtb3VzZWxlYXZlJyA9PT0gZXZlbnQudHlwZSA/IGZhbHNlIDogdGhpcy5pc01vdXNlSW50ZXJhY3RpdmU7XG5cdFx0XHRjb25zdCBpc0ZvY3VzSW50ZXJhY3RpdmVOb3cgPSAgICAnZm9jdXNpbicgPT09IGV2ZW50LnR5cGUgPyB0cnVlIDogICAnZm9jdXNvdXQnID09PSBldmVudC50eXBlID8gZmFsc2UgOiB0aGlzLmlzRm9jdXNJbnRlcmFjdGl2ZTtcblxuXHRcdFx0Ly8gdXBkYXRlIHRoZSBpbnRlcmFjdGl2ZSBzdGF0ZVxuXHRcdFx0Y29uc3QgaXNJbnB1dEludGVyYWN0aXZlTm93ID0gaXNNb3VzZUludGVyYWN0aXZlTm93IHx8IGlzRm9jdXNJbnRlcmFjdGl2ZU5vdztcblxuXHRcdFx0Ly8gaWYgdGhlIHZpc2liaWxpdHkgc3RhdGUgaGFzIGNoYW5nZWRcblx0XHRcdGlmIChpc1Zpc2libGVOb3cgIT09IHRoaXMuaXNWaXNpYmxlKSB7XG5cdFx0XHRcdC8vIGRpc3BhdGNoIGEgY2hhbmdlIGV2ZW50IHdoZW4gdGhlIGRvY3VtZW50IGNoYW5nZXMgdmlzaWJpbGl0eVxuXHRcdFx0XHR0aGlzLmlzVmlzaWJsZSA9IGlzVmlzaWJsZU5vdztcblxuXHRcdFx0XHRpZiAodGhpcy5hdXRvcGxheSkge1xuXHRcdFx0XHRcdHRoaXNbaXNWaXNpYmxlTm93ID8gJ3BsYXknIDogJ3BhdXNlJ10oKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goaXNWaXNpYmxlTm93ID8gJ3Zpc2liaWxpdHl2aXNpYmxlJyA6ICd2aXNpYmlsaXR5aGlkZGVuJywgZXZlbnQudGFyZ2V0KTtcblx0XHRcdFx0dGhpcy5kaXNwYXRjaCgndmlzaWJpbGl0eWNoYW5nZScsIGV2ZW50LnRhcmdldCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGlmIHRoZSBtb3VzZSBzdGF0ZSBoYXMgY2hhbmdlZFxuXHRcdFx0aWYgKGlzTW91c2VJbnRlcmFjdGl2ZU5vdyAhPT0gdGhpcy5pc01vdXNlSW50ZXJhY3RpdmUpIHtcblx0XHRcdFx0Ly8gZGlzcGF0Y2ggYSBjaGFuZ2UgZXZlbnQgd2hlbiBhIG1vdXNlIGlzIGVudGVyaW5nIG9yIGxlYXZpbmcgdGhlIGNhcm91c2VsXG5cdFx0XHRcdHRoaXMuaXNNb3VzZUludGVyYWN0aXZlID0gaXNNb3VzZUludGVyYWN0aXZlTm93O1xuXG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goaXNNb3VzZUludGVyYWN0aXZlTm93ID8gJ21vdXNlZW50ZXInIDogJ21vdXNlbGVhdmUnLCBldmVudC50YXJnZXQpO1xuXHRcdFx0XHR0aGlzLmRpc3BhdGNoKCdtb3VzZWNoYW5nZScsIGV2ZW50LnRhcmdldCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGlmIHRoZSBmb2N1cyBzdGF0ZSBoYXMgY2hhbmdlZFxuXHRcdFx0aWYgKGlzRm9jdXNJbnRlcmFjdGl2ZU5vdyAhPT0gdGhpcy5pc0ZvY3VzSW50ZXJhY3RpdmUpIHtcblx0XHRcdFx0Ly8gZGlzcGF0Y2ggYSBjaGFuZ2UgZXZlbnQgd2hlbiBhIGtleWJvYXJkIGlzIGVudGVyaW5nIG9yIGxlYXZpbmcgdGhlIGNhcm91c2VsXG5cdFx0XHRcdHRoaXMuaXNGb2N1c0ludGVyYWN0aXZlID0gaXNGb2N1c0ludGVyYWN0aXZlTm93O1xuXG5cdFx0XHRcdGlmICh0aGlzLmF1dG9wbGF5KSB7XG5cdFx0XHRcdFx0dGhpc1tpc0ZvY3VzSW50ZXJhY3RpdmVOb3cgPyAncGF1c2UnIDogJ3BsYXknXSgpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5kaXNwYXRjaChpc0ZvY3VzSW50ZXJhY3RpdmVOb3cgPyAnZm9jdXNlbnRlcicgOiAnZm9jdXNsZWF2ZScsIGV2ZW50LnRhcmdldCk7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goJ2ZvY3VzY2hhbmdlJywgZXZlbnQudGFyZ2V0KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gaWYgdGhlIGludGVyYWN0aXZlIHN0YXRlIGhhcyBjaGFuZ2VkXG5cdFx0XHRpZiAoaXNJbnB1dEludGVyYWN0aXZlTm93ICE9PSB0aGlzLmlzSW5wdXRJbnRlcmFjdGl2ZSkge1xuXHRcdFx0XHQvLyBkaXNwYXRjaCBhIGNoYW5nZSBldmVudCB3aGVuIGEgbW91c2Ugb3Iga2V5Ym9hcmQgaXMgZW50ZXJpbmcgb3IgbGVhdmluZyB0aGUgY2Fyb3VzZWxcblx0XHRcdFx0dGhpcy5pc0lucHV0SW50ZXJhY3RpdmUgPSBpc0lucHV0SW50ZXJhY3RpdmVOb3c7XG5cblx0XHRcdFx0dGhpcy5kaXNwYXRjaChpc0lucHV0SW50ZXJhY3RpdmVOb3cgPyAnaW5wdXRlbnRlcicgOiAnaW5wdXRsZWF2ZScsIGV2ZW50LnRhcmdldCk7XG5cdFx0XHRcdHRoaXMuZGlzcGF0Y2goJ2lucHV0Y2hhbmdlJywgZXZlbnQudGFyZ2V0KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBsaXN0ZW4gZm9yIHZpc2liaWxpdHkgY2hhbmdlc1xuXHRcdCR0YXJnZXQub3duZXJEb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgb25pbnRlcmFjdGl2ZWNoYW5nZSk7XG5cblx0XHQvLyBsaXN0ZW4gZm9yIGlucHV0IGV2ZW50c1xuXHRcdCR0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIG9uaW50ZXJhY3RpdmVjaGFuZ2UpO1xuXHRcdCR0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIG9uaW50ZXJhY3RpdmVjaGFuZ2UpO1xuXHRcdCR0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCAgIG9uZm9jdXNjaGFuZ2UpO1xuXHRcdCR0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsICAgIG9uZm9jdXNjaGFuZ2UpO1xuXG5cdFx0Ly8gbWFuYWdlIHRoZSBmb2N1cyBldmVudCAodXNpbmcgYSBzbGlnaHQgZGVsYXkpXG5cdFx0bGV0IGZvY3VzVGltZW91dDtcblxuXHRcdGZ1bmN0aW9uIG9uZm9jdXNjaGFuZ2UoKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQoZm9jdXNUaW1lb3V0KTtcblxuXHRcdFx0Zm9jdXNUaW1lb3V0ID0gc2V0VGltZW91dChvbmludGVyYWN0aXZlY2hhbmdlLCAwLCBldmVudCk7XG5cdFx0fVxuXG5cdFx0LyogSW5pdGlhbGl6ZSB0aGUgQ3VycmVudCBTbGlkZVxuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0Y29uc3QgY2FjaGVkSW5kZXggPSB0aGlzLmN1cnJlbnRJbmRleCB8fCAwO1xuXG5cdFx0dGhpcy5jdXJyZW50SW5kZXggPSBudWxsO1xuXG5cdFx0dGhpcy5zZXRTbGlkZUJ5SW5kZXgoY2FjaGVkSW5kZXgpO1xuXG5cdFx0LyogRGlzcGF0Y2ggdGhlIExvYWRlZCBFdmVudFxuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0dGhpcy5kaXNwYXRjaCgnbG9hZGVkJywgJHRhcmdldCk7XG5cblx0XHQvKiBTdGFydCBBdXRvcGxheVxuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0aWYgKHRoaXMuYXV0b3BsYXkpIHtcblx0XHRcdHRoaXMucGxheSgpO1xuXHRcdH1cblx0fVxuXG5cdC8qIFNldCBTbGlkZSBCeSBJbmRleFxuXHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRzZXRTbGlkZUJ5SW5kZXgoaW5kZXgpIHtcblx0XHRpZiAodGhpcy5jdXJyZW50SW5kZXggIT09IGluZGV4KSB7XG5cdFx0XHQvLyBzZXQgdGhlIGxlbmd0aCB1c2luZyB0aGUgdG90YWwgbnVtYmVyIG9mIHNsaWRlc1xuXHRcdFx0Y29uc3QgbGVuZ3RoICAgPSB0aGlzLnNsaWRlcy5sZW5ndGg7XG5cblx0XHRcdC8vIHNldCB0aGUgb2xkIGFuZCBuZXcgaW5kZXhlcyBhbmQgc2xpZGVzIHVzaW5nIGEgbW9kdWx1c1xuXHRcdFx0Y29uc3Qgb2xkSW5kZXggPSB0aGlzLmxhc3RJbmRleCA9IHRoaXMuY3VycmVudEluZGV4O1xuXHRcdFx0Y29uc3QgbmV3SW5kZXggPSB0aGlzLmN1cnJlbnRJbmRleCA9IChsZW5ndGggKyBpbmRleCAlIGxlbmd0aCkgJSBsZW5ndGg7XG5cblx0XHRcdGNvbnN0IG9sZFNsaWRlID0gdGhpcy5zbGlkZXNbb2xkSW5kZXhdO1xuXHRcdFx0Y29uc3QgbmV3U2xpZGUgPSB0aGlzLnNsaWRlc1tuZXdJbmRleF07XG5cblx0XHRcdGlmIChvbGRTbGlkZSkge1xuXHRcdFx0XHQvLyB1cGRhdGUgdGhlIG9sZCBzbGlkZVxuXHRcdFx0XHRvbGRTbGlkZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShgJHsgdGhpcy5wcmVmaXggfS1hY3RpdmUtc2xpZGVgKTtcblx0XHRcdFx0b2xkU2xpZGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoYCR7IHRoaXMucHJlZml4IH0taW5hY3RpdmUtc2xpZGVgKTtcblx0XHRcdFx0b2xkU2xpZGUudGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcblxuXHRcdFx0XHQvLyB1cGRhdGUgdGhlIG9sZCBzbGlkZSBjb250cm9sXG5cdFx0XHRcdG9sZFNsaWRlLmNvbnRyb2wuY2xhc3NMaXN0LnJlbW92ZShgJHsgdGhpcy5wcmVmaXggfS1hY3RpdmUtY29udHJvbGApO1xuXHRcdFx0XHRvbGRTbGlkZS5jb250cm9sLmNsYXNzTGlzdC5hZGQoYCR7IHRoaXMucHJlZml4IH0taW5hY3RpdmUtY29udHJvbGApO1xuXHRcdFx0XHRvbGRTbGlkZS5jb250cm9sLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1jdXJyZW50Jyk7XG5cdFx0XHRcdG9sZFNsaWRlLmNvbnRyb2wucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XG5cblx0XHRcdFx0Ly8gZGlzcGF0Y2ggdGhlIHNsaWRlbGVhdmUgZXZlbnQgZnJvbSB0aGUgb2xkIHNsaWRlIHRhcmdldFxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoKCdzbGlkZWxlYXZlJywgb2xkU2xpZGUudGFyZ2V0KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gdXBkYXRlIHRoZSBuZXcgc2xpZGVcblx0XHRcdG5ld1NsaWRlLnRhcmdldC5jbGFzc0xpc3QuYWRkKGAkeyB0aGlzLnByZWZpeCB9LWFjdGl2ZS1zbGlkZWApO1xuXHRcdFx0bmV3U2xpZGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoYCR7IHRoaXMucHJlZml4IH0taW5hY3RpdmUtc2xpZGVgKTtcblx0XHRcdG5ld1NsaWRlLnRhcmdldC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJyk7XG5cblx0XHRcdC8vIHVwZGF0ZSB0aGUgbmV3IHNsaWRlIGNvbnRyb2xcblx0XHRcdG5ld1NsaWRlLmNvbnRyb2wuY2xhc3NMaXN0LmFkZChgJHsgdGhpcy5wcmVmaXggfS1hY3RpdmUtY29udHJvbGApO1xuXHRcdFx0bmV3U2xpZGUuY29udHJvbC5jbGFzc0xpc3QucmVtb3ZlKGAkeyB0aGlzLnByZWZpeCB9LWluYWN0aXZlLWNvbnRyb2xgKTtcblx0XHRcdG5ld1NsaWRlLmNvbnRyb2wuc2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnLCB0cnVlKTtcblx0XHRcdG5ld1NsaWRlLmNvbnRyb2wuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgbmV3U2xpZGUudGFyZ2V0LmlkKTtcblxuXHRcdFx0Ly8gZGlzcGF0Y2ggc2xpZGVlbnRlciBhbmQgc2xpZGVjaGFuZ2UgZXZlbnRzIGZyb20gdGhlIG5ldyBzbGlkZSB0YXJnZXRcblx0XHRcdHRoaXMuZGlzcGF0Y2goJ3NsaWRlZW50ZXInLCBuZXdTbGlkZS50YXJnZXQpO1xuXHRcdFx0dGhpcy5kaXNwYXRjaCgnc2xpZGVjaGFuZ2UnLCBuZXdTbGlkZS50YXJnZXQpO1xuXHRcdH1cblx0fVxuXG5cdC8qIERpc3BhdGNoIGEgUHJlZml4ZWQgQ3VzdG9tIEV2ZW50IGJvdW5kIHRvIHRoZSBpbnN0YW5jZVxuXHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRkaXNwYXRjaCh0eXBlLCB0YXJnZXQpIHtcblx0XHRjb25zdCBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuXG5cdFx0ZXZlbnQuaW5pdEN1c3RvbUV2ZW50KGAkeyB0aGlzLnByZWZpeCB9OiR7IHR5cGUgfWAsIHRydWUsIGZhbHNlLCB0aGlzKTtcblxuXHRcdHRhcmdldC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcblx0fVxuXG5cdC8qIFN0YXJ0IGF1dG9tYXRpYyBTbGlkZSBwcm9ncmVzc2lvbiAodXNpbmcgRHVyYXRpb25zKVxuXHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRwbGF5KCkge1xuXHRcdGNvbnN0IG9ucGxheSA9ICgpID0+IHtcblx0XHRcdGNvbnN0IGR1cmF0aW9uID0gdGhpcy5zbGlkZXNbdGhpcy5jdXJyZW50SW5kZXhdLmR1cmF0aW9uIHx8IHRoaXMuZHVyYXRpb247XG5cblx0XHRcdHRoaXMuX2ludGVydmFsID0gc2V0VGltZW91dChcblx0XHRcdFx0KCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2V0U2xpZGVCeUluZGV4KHRoaXMuY3VycmVudEluZGV4ICsgMSk7XG5cblx0XHRcdFx0XHRpZiAodGhpcy5faW50ZXJ2YWwpIHtcblx0XHRcdFx0XHRcdHRoaXMuX2ludGVydmFsID0gY2xlYXJUaW1lb3V0KHRoaXMuX2ludGVydmFsKTtcblxuXHRcdFx0XHRcdFx0b25wbGF5KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRkdXJhdGlvblxuXHRcdFx0KTtcblx0XHR9O1xuXG5cdFx0aWYgKCF0aGlzLl9pbnRlcnZhbCkge1xuXHRcdFx0b25wbGF5KCk7XG5cblx0XHRcdHRoaXMuZGlzcGF0Y2goJ3BsYXknLCB0aGlzLnRhcmdldCk7XG5cdFx0XHR0aGlzLmRpc3BhdGNoKCdwbGF5cGF1c2UnLCB0aGlzLnRhcmdldCk7XG5cdFx0fVxuXHR9XG5cblx0LyogUGF1c2UgYXV0b21hdGljIFNsaWRlIHByb2dyZXNzaW9uXG5cdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdHBhdXNlKCkge1xuXHRcdGlmICh0aGlzLl9pbnRlcnZhbCkge1xuXHRcdFx0dGhpcy5faW50ZXJ2YWwgPSBjbGVhclRpbWVvdXQodGhpcy5faW50ZXJ2YWwpO1xuXG5cdFx0XHR0aGlzLmRpc3BhdGNoKCdwYXVzZScsIHRoaXMudGFyZ2V0KTtcblx0XHRcdHRoaXMuZGlzcGF0Y2goJ3BsYXlwYXVzZScsIHRoaXMudGFyZ2V0KTtcblx0XHR9XG5cdH1cbn1cblxuLy8gZGVmYXVsdCBvcHRpb25zXG5DYXJvdXNlbC5kZWZhdWx0cyA9IHtcblx0cHJlZml4OiAnY2Fyb3VzZWwnLFxuXHRzbGlkZXM6ICdsaScsXG5cdGN1cnJlbnRJbmRleDogMCxcblx0ZHVyYXRpb246IDgwMDAsXG5cdGF1dG9wbGF5OiBmYWxzZSxcblx0bGFuZzoge1xuXHRcdG5leHQ6ICdOZXh0Jyxcblx0XHRwcmV2aW91czogJ1ByZXZpb3VzJyxcblx0XHRzbGlkZTogJ1NsaWRlJ1xuXHR9XG59O1xuIl0sIm5hbWVzIjpbIkNhcm91c2VsIiwiaWQiLCJyYXdvcHRzIiwib25mb2N1c2NoYW5nZSIsImZvY3VzVGltZW91dCIsInNldFRpbWVvdXQiLCJvbmludGVyYWN0aXZlY2hhbmdlIiwiZXZlbnQiLCJvcHRzIiwiT2JqZWN0Iiwia2V5IiwiZGVmYXVsdHMiLCIkdGFyZ2V0IiwidGhpcyIsInRhcmdldCIsIkVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJhZGQiLCJwcmVmaXgiLCJpbml0SW1tZWRpYXRlQ29udHJvbCIsInZhcmlhdGlvbiIsIm9mZnNldCIsIiRjb250cm9sIiwiX3RoaXMiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldFNsaWRlQnlJbmRleCIsImN1cnJlbnRJbmRleCIsImFwcGVuZENoaWxkIiwiY3JlYXRlVGV4dE5vZGUiLCJsYW5nIiwic2xpZGUiLCJpbnNlcnRCZWZvcmUiLCJwcmV2aW91c0NvbnRyb2wiLCJmaXJzdEVsZW1lbnRDaGlsZCIsIm5leHRDb250cm9sIiwiJHBhZ2luYXRpb24iLCJwYWdpbmF0aW9uQ29udHJvbHMiLCJzZXRBdHRyaWJ1dGUiLCJwYWdpbmF0aW9uQ29udHJvbCIsInNsaWRlcyIsIm1hcCIsImNhbGwiLCJsZW5ndGgiLCJxdWVyeVNlbGVjdG9yQWxsIiwiJHNsaWRlIiwiaW5kZXgiLCJpc1Zpc2libGUiLCJpc01vdXNlSW50ZXJhY3RpdmUiLCJpc0ZvY3VzSW50ZXJhY3RpdmUiLCJpc0lucHV0SW50ZXJhY3RpdmUiLCJpc1Zpc2libGVOb3ciLCJ0eXBlIiwib3duZXJEb2N1bWVudCIsInZpc2liaWxpdHlTdGF0ZSIsImlzTW91c2VJbnRlcmFjdGl2ZU5vdyIsImlzRm9jdXNJbnRlcmFjdGl2ZU5vdyIsImlzSW5wdXRJbnRlcmFjdGl2ZU5vdyIsImF1dG9wbGF5IiwiZGlzcGF0Y2giLCJjYWNoZWRJbmRleCIsInBsYXkiLCJvbGRJbmRleCIsImxhc3RJbmRleCIsIm5ld0luZGV4Iiwib2xkU2xpZGUiLCJuZXdTbGlkZSIsInJlbW92ZSIsImNvbnRyb2wiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjcmVhdGVFdmVudCIsImluaXRDdXN0b21FdmVudCIsImRpc3BhdGNoRXZlbnQiLCJfaW50ZXJ2YWwiLCJvbnBsYXkiLCJkdXJhdGlvbiIsIl90aGlzMiIsImNsZWFyVGltZW91dCJdLCJtYXBwaW5ncyI6IjZYQUNxQkEsd0JBQ1JDLEVBQUlDLFlBMkxOQyxpQkFDS0MsS0FFRUMsV0FBV0MsRUFBcUIsRUFBR0MsZ0NBMUw3Q0MsRUFBT0MsT0FBT1AsT0FHZixJQUFJUSxLQUFPVixFQUFTVyxjQUNuQkQsR0FBT0EsS0FBT0YsRUFBT0EsRUFBS0UsR0FBT1YsRUFBU1csU0FBU0QsT0FNbkRFLEVBQVVDLEtBQUtDLE9BQVNiLGFBQWNjLFFBQVVkLEVBQUtlLFNBQVNDLGNBQWNoQixLQUcxRWlCLFVBQVVDLElBQUlOLEtBQUtPLFVBR25CbkIsR0FBS1csRUFBUVgsSUFBTVksS0FBS08sV0FLMUJDLEVBQXVCLFNBQUNDLEVBQVdDLE9BQ2xDQyxFQUFXQyxFQUFLSCxFQUFZLFdBQWFOLFNBQVNVLGNBQWMsWUFFN0RDLFVBQWdCRixFQUFLTCw2QkFBOEJLLEVBQUtMLFdBQVlFLGVBRXBFTSxpQkFBaUIsUUFBUyxhQUM3QkMsZ0JBQWdCSixFQUFLSyxhQUFlUCxPQUlqQ1EsWUFDUmYsU0FBU1UsY0FBYyxTQUN0QkssWUFDRGYsU0FBU2dCLGVBQW1CUCxFQUFLUSxLQUFLWCxPQUFnQkcsRUFBS1EsS0FBS0MsV0FLN0MsWUFBYSxLQUNiLE9BQVEsS0FHckJDLGFBQWF0QixLQUFLdUIsZ0JBQWlCeEIsRUFBUXlCLHFCQUczQ04sWUFBWWxCLEtBQUt5QixpQkFLbkJDLEVBQWMxQixLQUFLMkIsbUJBQXFCeEIsU0FBU1UsY0FBYyxTQUV6REMsVUFBZ0JkLEtBQUtPLGdDQUVyQnFCLGFBQWEsT0FBUSxnQkFDckJBLGFBQWEsa0JBQW1CN0IsRUFBUVgsTUFHNUM4QixZQUFZUSxRQUtmRyww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"}